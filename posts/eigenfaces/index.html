<!doctype html>

<html lang="en">

<head>
  
<script async src="https://www.googletagmanager.com/gtag/js?id=G-HGKQHXWFN7"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-HGKQHXWFN7');
</script>


<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-M72HGJH');</script>

  <title>Recognizing facial expression with eigenfaces - Diego Hernández Jiménez</title>
  <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="description" content="Kiera: A Hugo theme for creative and technical writing." />
<meta name="author" content="Example" /><meta property="og:title" content="Recognizing facial expression with eigenfaces" />
<meta property="og:description" content="Building of a simple facial expression recognition system based on Singular Value Decomposition.
Description Convolutional neural networks are the state of the art in virtually all tasks related with object recognition." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://diego-hernandez-jimenez.github.io/web/posts/eigenfaces/" />
<meta property="article:published_time" content="2022-06-12T00:00:00+02:00" />
<meta property="article:modified_time" content="2022-06-12T00:00:00+02:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Recognizing facial expression with eigenfaces"/>
<meta name="twitter:description" content="Building of a simple facial expression recognition system based on Singular Value Decomposition.
Description Convolutional neural networks are the state of the art in virtually all tasks related with object recognition."/>

<meta name="generator" content="Hugo 0.74.3" />
    
    <link rel="shortcut icon" href="https://diego-hernandez-jimenez.github.io/web/images/Dicon.ico" />
  
    <script src="https://diego-hernandez-jimenez.github.io/web/js/mathjax-config.js" defer></script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js" integrity="sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4" crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js" integrity="sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC+Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa" crossorigin="anonymous"
        onload="renderMathInElement(document.body);"></script>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css" integrity="sha256-l85OmPOjvil/SOvVt3HnSSjzF1TUMyT9eV0c2BzEGzU=" crossorigin="anonymous" />
  <link rel="stylesheet" href="https://diego-hernandez-jimenez.github.io/web/fontawesome/css/all.min.css" />
  
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Slab|Ruda" />
  
  
  <link rel="stylesheet" type="text/css" href="https://diego-hernandez-jimenez.github.io/web/css/styles.css" /></head>

<body>
  <div id="container">
    <header>
      <h1>
                <a href="https://diego-hernandez-jimenez.github.io/web/">Diego Hernández Jiménez</a>
            </h1>

      <ul id="social-media">
             <li>
               <a href="https://github.com/Diego-Hernandez-Jimenez" title="GitHub">
               <i class="fab fa-github fa-lg"></i>
               </a>
             </li>
             <li>
               <a href="https://linkedin.com/in/diego-hern%c3%a1ndez-jim%c3%a9nez" title="LinkedIn">
               <i class="fab fa-linkedin fa-lg"></i>
               </a>
             </li>
      </ul>
      
      <p><em>Welcome to my personal website! Here I share some of my little projects.</em></p>
      
    </header>

    
<nav>
    <ul>
        
        <li>
            <a class="" href="https://diego-hernandez-jimenez.github.io/web/tags">
                <i class="fa-li fa  fa-lg"></i><span>Tags</span>
            </a>
        </li>
        
        <li>
            <a class="" href="https://diego-hernandez-jimenez.github.io/web/posts/">
                <i class="fa-li fa  fa-lg"></i><span>Projects</span>
            </a>
        </li>
        
        <li>
            <a class="" href="https://diego-hernandez-jimenez.github.io/web/about/">
                <i class="fa-li fa  fa-lg"></i><span>About</span>
            </a>
        </li>
        
        <li>
            <a class="" href="https://diego-hernandez-jimenez.github.io/web/contact/">
                <i class="fa-li fa  fa-lg"></i><span>Contact</span>
            </a>
        </li>
        
    </ul>
</nav>


    <main>




<article>

    <h1>Recognizing facial expression with eigenfaces</h1>

    
      <aside>
    <ul>
        <li>
            <time class="post-date" datetime="2022-06-12T00:00:00&#43;02:00">Jun 12, 2022</time>
        </li>
        
        <li>
            Categories:
            <em>
                
                    
                    <a href="https://diego-hernandez-jimenez.github.io/web/categories/projects">Projects</a>
                
            </em>
        </li>
        

        
        <li>
            <em>
                
                    
                    <a href="https://diego-hernandez-jimenez.github.io/web/tags/r">#R</a>
                
                    , 
                    <a href="https://diego-hernandez-jimenez.github.io/web/tags/for-fun">#For fun</a>
                
            </em>
        </li>
        

        <li>3 minutes read</li>
    </ul>
</aside>

    

    


    <p>Building of a simple facial expression recognition system based on Singular Value Decomposition.</p>
<h3 id="description">Description</h3>
<p>Convolutional neural networks are the state of the art in virtually all tasks related with object recognition. However it&rsquo;s worth visiting some of the older techniques used in this area.</p>
<p>In 1991, Turk &amp; Pentland proposed the &ldquo;eigenface&rdquo; approach, which is based on matrix factorization, specifically the Singular Value Decomposition (SVD), one the fundamental matrix factorization techniques in linear algebra. And also one of the most widely used.</p>
<p>In this project I&rsquo;ve tried to implement that strategy. I&rsquo;ve added an additional goal. The aim is to recognize facial expressions, not just faces as a whole.The dataset I&rsquo;m using for this purpose was created by Ebner et al. (2010).</p>
<p>I&rsquo;ve covered the details in this <a href="https://diego-hernandez-jimenez.github.io/web/projects/eigfaces_R.pdf">report</a>, but the main ideas are the following:</p>
<ol>
<li>Edit the photos. Here that means converting them to grayscale (so that when we transform them in matrices we have only two dimensions), reducing the resolution (smaller images, less computational cost) and cropping them (in order to remove uninteresting parts, like the background or the hair).</li>
</ol>
<p><img src="https://diego-hernandez-jimenez.github.io/web/images/origVSproc.jpg" alt="original vs processed"></p>
<ol start="2">
<li>
<p>Reshape each image into a p $\times$ 1 vector (p = width · height). We can arrange the n pictures to form the matrix ${\bf X}_{p\times n}$</p>
</li>
<li>
<p>Split the data into train and test set. In this case, every person took two photos. We have a version of every facial expression of each person, so the split is easy and we get two equivalent sets.</p>
</li>
<li>
<p>Perform SVD (details in the report) on the training data. In essence, it will decompose the original matrix into 3 matrices. In this case, the first one contains the eigenvectors (eigenfaces). &ldquo;These eigenvectors can be thought of as a set of features that together characterize the variation between face images.&rdquo; (Turk &amp; Pentland, 1991). &ldquo;Some principal components may capture the most common features shared among all human faces, while other principal components will be more useful for distinguishing between individuals. Additional principal components may capture differences in lighting angles.&rdquo; (Brunton &amp; Kutz, 2020). The choice of the number of principal components/eigenfaces to keep depends on the analyst. I chose to keep 10 (out of 36)</p>
</li>
</ol>
<p>Here are some examples of the eigenfaces generated (when reshaped and converted back to images)</p>
<p><img src="https://diego-hernandez-jimenez.github.io/web/images/eigfaces1to3.jpg" alt="first eigenfaces"></p>
<p>I know, it&rsquo;s a bit creepy.</p>
<ol start="4">
<li>Create a classifier. In order to do that, we project all the images in the new low-dimensional space of faces. That basically means obtaining their representation in the new space. We do the same with a new image. We then compare this representation  with each of the projected train images (with the euclidean distance). The decision rule is to match the new presented image with the most similar image from the training set.</li>
</ol>
<p>The results were: accuracy of 1 when the task was to match persons (ignoring everything else), accuracy of 0.61 when the correct match of facial expression was evaluated. The results are not that bad, considering the small sample size and that the expected accuracy for the facial expression matching task when choosing at random is 1/6 (approx. 0.16)</p>
<p>In the report I add some extra information if you want to know more. The code is available <a href="https://github.com/Diego-Hernandez-Jimenez/eigenfaces">here</a>.</p>
<h3 id="references">References</h3>
<p>Brunton, S. L., &amp; Kutz, J. N. (2020). Singular Value Decomposition (SVD). In S.L. Brunton &amp; J.N. Kutz, <em>Data-driven science and engineering: Machine learning, dynamical systems, and control</em>, (pp. 1-47). Cambridge University Press.</p>
<p>Ebner, N., Riediger, M., &amp; Lindenberger, U. (2010). FACES—A database of facial expressions in young, middle-aged, and older women and men: Development and validation. <em>Behavior research Methods</em>, 42, 351-362. doi:10.3758/BRM.42.1.351.</p>
<p>Turk, M., &amp; Pentland, A. (1991). Eigenfaces for recognition. <em>Journal of cognitive neuroscience</em>, 3(1), 71-86.</p>


</article>


<section class="post-nav">
    <ul>
        
        <li>
            <a href="https://diego-hernandez-jimenez.github.io/web/posts/bayesianregression/"><i class="fa fa-chevron-circle-left"></i> Distinguishing between real and imagined memories with Bayesian logistic regression</a>
        </li>
        
        
        <li>
            <a href="https://diego-hernandez-jimenez.github.io/web/posts/sql_imdb/">SQL and Python to explore IMDb movies <i class="fa fa-chevron-circle-right"></i> </a>
        </li>
        
    </ul>
</section>
  
    
    
  





</main>
    <footer>
        <h6>Copyright &amp; copy; 2020 - Diego Hernández Jiménez |
            Rendered by <a href="https://gohugo.io" title="Hugo">Hugo</a> |
            <a href="https://diego-hernandez-jimenez.github.io/web/index.xml">Subscribe </a></h6>
    </footer>
</div>
<script src="https://diego-hernandez-jimenez.github.io/web/js/scripts.js"></script>

</body>

</html>

