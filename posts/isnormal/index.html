<!doctype html>

<html lang="en">

<head>
  
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-M72HGJH');</script>

  <title>Is it normal? - Diego Hernández Jiménez</title>
  <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="description" content="Kiera: A Hugo theme for creative and technical writing." />
<meta name="author" content="Example" /><meta property="og:title" content="Is it normal?" />
<meta property="og:description" content="Function to support the Kolmogorov-Smirnov test (for normality) graphically.
Description A common task for many scientists, regarding data analysis, and especially in behavioral sciences, is to test if some variable of interest is normally distributed." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://diego-hernandez-jimenez.github.io/web/posts/isnormal/" />
<meta property="article:published_time" content="2020-10-20T00:00:00+02:00" />
<meta property="article:modified_time" content="2020-10-20T00:00:00+02:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Is it normal?"/>
<meta name="twitter:description" content="Function to support the Kolmogorov-Smirnov test (for normality) graphically.
Description A common task for many scientists, regarding data analysis, and especially in behavioral sciences, is to test if some variable of interest is normally distributed."/>

<meta name="generator" content="Hugo 0.74.3" />
    
    <link rel="shortcut icon" href="https://diego-hernandez-jimenez.github.io/web/images/Dicon.ico" />
  
    <script src="https://diego-hernandez-jimenez.github.io/web/js/mathjax-config.js" defer></script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js" integrity="sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4" crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js" integrity="sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC+Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa" crossorigin="anonymous"
        onload="renderMathInElement(document.body);"></script>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css" integrity="sha256-l85OmPOjvil/SOvVt3HnSSjzF1TUMyT9eV0c2BzEGzU=" crossorigin="anonymous" />
  <link rel="stylesheet" href="https://diego-hernandez-jimenez.github.io/web/fontawesome/css/all.min.css" />
  
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Slab|Ruda" />
  
  
  <link rel="stylesheet" type="text/css" href="https://diego-hernandez-jimenez.github.io/web/css/styles.css" /></head>

<body>
  <div id="container">
    <header>
      <h1>
                <a href="https://diego-hernandez-jimenez.github.io/web/">Diego Hernández Jiménez</a>
            </h1>

      <ul id="social-media">
             <li>
               <a href="https://github.com/Diego-Hernandez-Jimenez" title="GitHub">
               <i class="fab fa-github fa-lg"></i>
               </a>
             </li>
             <li>
               <a href="https://linkedin.com/in/diego-hern%c3%a1ndez-jim%c3%a9nez" title="LinkedIn">
               <i class="fab fa-linkedin fa-lg"></i>
               </a>
             </li>
      </ul>
      
      <p><em>Welcome to my personal website! Here I share some of my little projects.</em></p>
      
    </header>

    
<nav>
    <ul>
        
        <li>
            <a class="" href="https://diego-hernandez-jimenez.github.io/web/tags">
                <i class="fa-li fa  fa-lg"></i><span>Tags</span>
            </a>
        </li>
        
        <li>
            <a class="" href="https://diego-hernandez-jimenez.github.io/web/posts/">
                <i class="fa-li fa  fa-lg"></i><span>Projects</span>
            </a>
        </li>
        
        <li>
            <a class="" href="https://diego-hernandez-jimenez.github.io/web/about/">
                <i class="fa-li fa  fa-lg"></i><span>About</span>
            </a>
        </li>
        
        <li>
            <a class="" href="https://diego-hernandez-jimenez.github.io/web/contact/">
                <i class="fa-li fa  fa-lg"></i><span>Contact</span>
            </a>
        </li>
        
    </ul>
</nav>


    <main>




<article>

    <h1>Is it normal?</h1>

    
      <aside>
    <ul>
        <li>
            <time class="post-date" datetime="2020-10-20T00:00:00&#43;02:00">Oct 20, 2020</time>
        </li>
        
        <li>
            Categories:
            <em>
                
                    
                    <a href="https://diego-hernandez-jimenez.github.io/web/categories/coding">Coding</a>
                
            </em>
        </li>
        

        
        <li>
            <em>
                
                    
                    <a href="https://diego-hernandez-jimenez.github.io/web/tags/for-fun">#For fun</a>
                
                    , 
                    <a href="https://diego-hernandez-jimenez.github.io/web/tags/python">#Python</a>
                
            </em>
        </li>
        

        <li>3 minutes read</li>
    </ul>
</aside>

    

    


    <p>Function to support the Kolmogorov-Smirnov test (for normality) graphically.</p>
<h3 id="description">Description</h3>
<p>A common task for many scientists, regarding data analysis, and especially in behavioral sciences, is to test if some variable of interest is normally distributed. One of the statistical techniques that is usually used is the Kolmogorov-Smirnov test (KS).It is based on the comparison of two distribution functions, one empirical ($F(Y_i)$), estimated from the collected data, and one theoretical ($F(Y_0)$). With KS we can test the null hypothesis that the empirical distribution is equal to the theoretical distribution, in this case, the normal distribution, with the parameters that we specify.</p>
<p>$$
\begin{aligned}
H_0:F(Y_i)=F(Y_0)
\end{aligned}
$$</p>
<p>$$
\begin{aligned}
H_1:F(Y_i)\neq F(Y_0)
\end{aligned}
$$</p>
<p>Eventhough this technique is very useful, it can be misleading sometimes because with big samples, even small deviations from normality are deemed statistically significant. To avoid dichotomic thinking (significant='bad&rsquo; and non-significant='good&rsquo;), we can complement this test with some plots. Because KS is based on the comparison of two distribution functions, we can literally show this comparison by plotting the theoretical cumulative distribution function and the empirical distribution function. The goodness of fit can be assessed by looking if the two curves plotted overlap or not.</p>
<h3 id="code">Code</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">ks_test</span>(Yi,mu,sigma):
    <span style="color:#e6db74">&#34;&#34;&#34;
</span><span style="color:#e6db74">    Takes an array of values and returns its CDF and
</span><span style="color:#e6db74">    its theoretical CDF if it were normal. Also returns
</span><span style="color:#e6db74">    the value of the DKS statistic.
</span><span style="color:#e6db74">
</span><span style="color:#e6db74">    Parameters
</span><span style="color:#e6db74">    ----------
</span><span style="color:#e6db74">    Yi : 1-D array-like (np.array or list)
</span><span style="color:#e6db74">        Vector of values that correspond to the observed values
</span><span style="color:#e6db74">        of our variable of interest.
</span><span style="color:#e6db74">    mu : int or float
</span><span style="color:#e6db74">        Expected value of the normal distribution we are testing.
</span><span style="color:#e6db74">    sigma : int or float
</span><span style="color:#e6db74">        Standard deviation of the normal distribution we are testing.
</span><span style="color:#e6db74">
</span><span style="color:#e6db74">    Returns
</span><span style="color:#e6db74">    -------
</span><span style="color:#e6db74">    float.
</span><span style="color:#e6db74">        Value corresponding to the statistic DKS:
</span><span style="color:#e6db74">            DKS=max(abs(empirical_CDF - theoretical_CDF))
</span><span style="color:#e6db74">
</span><span style="color:#e6db74">    &#34;&#34;&#34;</span>
    
    sorted_Yi<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>sort(Yi)
    emp_cdf<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>arange(start<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>,stop<span style="color:#f92672">=</span>len(Yi)<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">/</span>(len(Yi))
    theor_cdf<span style="color:#f92672">=</span>norm<span style="color:#f92672">.</span>cdf(sorted_Yi,loc<span style="color:#f92672">=</span>mu,scale<span style="color:#f92672">=</span>sigma)
    DKS<span style="color:#f92672">=</span>max(abs(emp_cdf<span style="color:#f92672">-</span>theor_cdf))
    
    fig,ax<span style="color:#f92672">=</span>plt<span style="color:#f92672">.</span>subplots()

    fig<span style="color:#f92672">.</span>suptitle(<span style="color:#e6db74">&#39;Kolmogorov-Smirnov visual test&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">14</span>, fontweight<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;bold&#39;</span>)

    ax<span style="color:#f92672">.</span>scatter(sorted_Yi,emp_cdf,
               label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Empirical CDF&#39;</span>,
               c<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;#ff6b6b&#39;</span>,
               edgecolor<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;black&#39;</span>,
               linewidths<span style="color:#f92672">=.</span><span style="color:#ae81ff">7</span>,
              alpha<span style="color:#f92672">=.</span><span style="color:#ae81ff">8</span>)
    ax<span style="color:#f92672">.</span>plot(sorted_Yi,emp_cdf,c<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;#ff6b6b&#39;</span>,alpha<span style="color:#f92672">=.</span><span style="color:#ae81ff">4</span>) <span style="color:#75715e"># just to see the &#39;trajectory of the points&#39;</span>

    ax<span style="color:#f92672">.</span>scatter(sorted_Yi,theor_cdf,
               label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Theoretical CDF&#39;</span>,
               c<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;#4ecdc4&#39;</span>,
               edgecolor<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;black&#39;</span>,
               linewidths<span style="color:#f92672">=.</span><span style="color:#ae81ff">7</span>,
              alpha<span style="color:#f92672">=.</span><span style="color:#ae81ff">8</span>)
    ax<span style="color:#f92672">.</span>plot(sorted_Yi,theor_cdf,c<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;#4ecdc4&#39;</span>,alpha<span style="color:#f92672">=.</span><span style="color:#ae81ff">4</span>) <span style="color:#75715e"># just to see the &#39;trajectory of the points&#39;</span>

    <span style="color:#66d9ef">if</span> isinstance(Yi,pd<span style="color:#f92672">.</span>Series):
        ax<span style="color:#f92672">.</span>set_xlabel(Yi<span style="color:#f92672">.</span>name)
    <span style="color:#66d9ef">else</span>:
        ax<span style="color:#f92672">.</span>set_xlabel(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;$Y_i$&#39;</span>)
    ax<span style="color:#f92672">.</span>set_ylabel(<span style="color:#e6db74">&#39;Cumulative probability&#39;</span>)
    ax<span style="color:#f92672">.</span>legend(loc<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;center right&#39;</span>);
    
    <span style="color:#66d9ef">return</span> DKS

</code></pre></div><h3 id="some-examples">Some examples</h3>
<p>Imagine we want to know if newborns from mother who smoke tend to weigth less. Now imagine we can only collect data from 14 babies. It&rsquo;s a very small sample, so we can&rsquo;t rely on the Central Limit Theorem. Before trying to compare means or something like that, it would be necessary to check if we can assume that variable &lsquo;weigth of newborns&rsquo; is normally distributed. We can quickly do that with the KS &lsquo;visual&rsquo; test.</p>
<ul>
<li>Weigths corresponding to the 14 babies</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">
Yi<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>array([<span style="color:#ae81ff">1.48</span>, <span style="color:#ae81ff">1.8</span>, <span style="color:#ae81ff">1.93</span>, <span style="color:#ae81ff">1.98</span>, <span style="color:#ae81ff">2.04</span>, <span style="color:#ae81ff">2.08</span>, <span style="color:#ae81ff">2.18</span>,
            <span style="color:#ae81ff">2.2</span>, <span style="color:#ae81ff">2.3</span>, <span style="color:#ae81ff">2.45</span>, <span style="color:#ae81ff">2.47</span>, <span style="color:#ae81ff">3.15</span>, <span style="color:#ae81ff">3.46</span>, <span style="color:#ae81ff">4.64</span>]) <span style="color:#75715e"># data from Pardo &amp; Ruiz (2015) pp.68</span>
</code></pre></div><ul>
<li>Is the data normally distributed with mean equal to 2.5 and standard deviation equal to 1?</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">ks_test(Yi,mu<span style="color:#f92672">=</span><span style="color:#ae81ff">2.5</span>,sigma<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
</code></pre></div><p><img src="https://diego-hernandez-jimenez.github.io/web/images/ksexample.png" alt="fancy plot of CDFs"></p>
<p>We can see that the data is clearly not normal.</p>
<p>Let&rsquo;s look at another example. This one is made to show what happens when the variable is normal. We have a sample of 100 observations corresponding to scores in some recently developed intelligence test.</p>
<ul>
<li>IQ scores of 100 people</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">IQ<span style="color:#f92672">=</span>pd<span style="color:#f92672">.</span>DataFrame(np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>normal(loc<span style="color:#f92672">=</span><span style="color:#ae81ff">100</span>,scale<span style="color:#f92672">=</span><span style="color:#ae81ff">15</span>,size<span style="color:#f92672">=</span><span style="color:#ae81ff">100</span>),
                columns<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;IQ Scores&#39;</span>])
</code></pre></div><ul>
<li>Are the scores of our test normally distributed with mean equal to 100 and standard deviation equal to 15?</li>
</ul>
<p><img src="https://diego-hernandez-jimenez.github.io/web/images/ksexampleci.png" alt="fancy plot of CDFs"></p>
<p>There is a great overlap, so we can conclude that the variable follows a normal distribution with $\mu$=100 and $\sigma$=15.</p>
<p>If you want to see the complete code, you can visit my <a href="https://github.com/Diego-Hernandez-Jimenez/Kolmogorov-Smirnov-visual-test">Github</a> profile.</p>


</article>


<section class="post-nav">
    <ul>
        
        <li>
            <a href="https://diego-hernandez-jimenez.github.io/web/posts/googleux/"><i class="fa fa-chevron-circle-left"></i> Who is the next Google&#39;s UX engineer?</a>
        </li>
        
        
        <li>
            <a href="https://diego-hernandez-jimenez.github.io/web/posts/integral/">Definite integral <i class="fa fa-chevron-circle-right"></i> </a>
        </li>
        
    </ul>
</section>
  
    
    
  





</main>
    <footer>
        <h6>Copyright &amp; copy; 2020 - Diego Hernández Jiménez |
            Rendered by <a href="https://gohugo.io" title="Hugo">Hugo</a> |
            <a href="https://diego-hernandez-jimenez.github.io/web/index.xml">Subscribe </a></h6>
    </footer>
</div>
<script src="https://diego-hernandez-jimenez.github.io/web/js/scripts.js"></script>

</body>

</html>

