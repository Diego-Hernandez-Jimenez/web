<!doctype html>

<html lang="en">

<head>
  
<script async src="https://www.googletagmanager.com/gtag/js?id=G-HGKQHXWFN7"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-HGKQHXWFN7');
</script>


<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-M72HGJH');</script>

  <title>Newton method from scratch - Diego Hernández Jiménez</title>
  <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="description" content="Kiera: A Hugo theme for creative and technical writing." />
<meta name="author" content="Example" /><meta property="og:title" content="Newton method from scratch" />
<meta property="og:description" content="Attemp to implement the Newton-Raphson method in Python
Description Studying calculus I found this interesting numeric method for approximating the real zeros of a function. That is, for estimating solutions for equations of the form $f(x)=0$." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://diego-hernandez-jimenez.github.io/web/posts/newtonmet/" />
<meta property="article:published_time" content="2020-09-01T00:00:00+02:00" />
<meta property="article:modified_time" content="2020-09-01T00:00:00+02:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Newton method from scratch"/>
<meta name="twitter:description" content="Attemp to implement the Newton-Raphson method in Python
Description Studying calculus I found this interesting numeric method for approximating the real zeros of a function. That is, for estimating solutions for equations of the form $f(x)=0$."/>

<meta name="generator" content="Hugo 0.74.3" />
    
    <link rel="shortcut icon" href="https://diego-hernandez-jimenez.github.io/web/images/Dicon.ico" />
  
    <script src="https://diego-hernandez-jimenez.github.io/web/js/mathjax-config.js" defer></script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js" integrity="sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4" crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js" integrity="sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC+Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa" crossorigin="anonymous"
        onload="renderMathInElement(document.body);"></script>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css" integrity="sha256-l85OmPOjvil/SOvVt3HnSSjzF1TUMyT9eV0c2BzEGzU=" crossorigin="anonymous" />
  <link rel="stylesheet" href="https://diego-hernandez-jimenez.github.io/web/fontawesome/css/all.min.css" />
  
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Slab|Ruda" />
  
  
  <link rel="stylesheet" type="text/css" href="https://diego-hernandez-jimenez.github.io/web/css/styles.css" /></head>

<body>
  <div id="container">
    <header>
      <h1>
                <a href="https://diego-hernandez-jimenez.github.io/web/">Diego Hernández Jiménez</a>
            </h1>

      <ul id="social-media">
             <li>
               <a href="https://github.com/Diego-Hernandez-Jimenez" title="GitHub">
               <i class="fab fa-github fa-lg"></i>
               </a>
             </li>
             <li>
               <a href="https://linkedin.com/in/diego-hern%c3%a1ndez-jim%c3%a9nez" title="LinkedIn">
               <i class="fab fa-linkedin fa-lg"></i>
               </a>
             </li>
      </ul>
      
      <p><em>Welcome to my personal website! Here I share some of my little projects.</em></p>
      
    </header>

    
<nav>
    <ul>
        
        <li>
            <a class="" href="https://diego-hernandez-jimenez.github.io/web/tags">
                <i class="fa-li fa  fa-lg"></i><span>Tags</span>
            </a>
        </li>
        
        <li>
            <a class="" href="https://diego-hernandez-jimenez.github.io/web/posts/">
                <i class="fa-li fa  fa-lg"></i><span>Projects</span>
            </a>
        </li>
        
        <li>
            <a class="" href="https://diego-hernandez-jimenez.github.io/web/about/">
                <i class="fa-li fa  fa-lg"></i><span>About</span>
            </a>
        </li>
        
        <li>
            <a class="" href="https://diego-hernandez-jimenez.github.io/web/contact/">
                <i class="fa-li fa  fa-lg"></i><span>Contact</span>
            </a>
        </li>
        
    </ul>
</nav>


    <main>




<article>

    <h1>Newton method from scratch</h1>

    
      <aside>
    <ul>
        <li>
            <time class="post-date" datetime="2020-09-01T00:00:00&#43;02:00">Sep 1, 2020</time>
        </li>
        
        <li>
            Categories:
            <em>
                
                    
                    <a href="https://diego-hernandez-jimenez.github.io/web/categories/coding">Coding</a>
                
            </em>
        </li>
        

        
        <li>
            <em>
                
                    
                    <a href="https://diego-hernandez-jimenez.github.io/web/tags/for-fun">#For fun</a>
                
                    , 
                    <a href="https://diego-hernandez-jimenez.github.io/web/tags/python">#Python</a>
                
            </em>
        </li>
        

        <li>3 minutes read</li>
    </ul>
</aside>

    

    


    <p>Attemp to implement the Newton-Raphson method in Python</p>
<h3 id="description">Description</h3>
<p>Studying calculus I found this interesting numeric method for approximating the real zeros of a function.
That is, for estimating solutions for equations of the form $f(x)=0$. The algorithm can be described as follows <a href="https://www.amazon.com/-/es/Ron-Larson/dp/1285057090">(Larson &amp; Edwards, 2013)</a>:</p>
<p>Let $f(c)=0$. where $f$ is differentiable on an open interval containing $c$. Then, to approximate $c$, use these steps.</p>
<ol>
<li>
<p>Make an initial estimate $x_1$ that is close to $c$</p>
</li>
<li>
<p>Determine a new approximation $x_{n+1}=x_n-\frac{f(x_n)}{f&rsquo;(x_n)}$.</p>
</li>
<li>
<p>When $|x_n-x_{n+1}|$ is within the desired accuracy, let $x_{n+1}$ serve as the final approximation. Otherwise, return to Step 2 and calculate a new approximation.</p>
</li>
</ol>
<p>However, this method doesn&rsquo;t always yield a convergent sequence. This is an important issue. It means that there are functions whose zeros can&rsquo;t be approximated using this technique. If we don&rsquo;t detect those cases, we will end up applying the Newton method indefinitley without ever reaching a solution. Luckily, it can be shown that a condition sufficient to produce convergence to a zero of $f$ is that $\left|\frac{f(x)f&rsquo;'(x)}{[f&rsquo;(x)]^2}\right|&lt;1$ on an open interval containing the zero.</p>
<p>Now that we have all the necessary &lsquo;ingredients&rsquo; for our function, let&rsquo;s see how it could be implemented.</p>
<h3 id="code">Code</h3>
<ul>
<li>Iterative formula:</li>
</ul>
<p>$x_{n+1}=x_n-\frac{f(x_n)}{f&rsquo;(x_n)}$</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">iterative_formula</span>(f,x_n):
    
    <span style="color:#f92672">from</span> scipy.misc <span style="color:#f92672">import</span> derivative
    
    x_n1<span style="color:#f92672">=</span>x_n<span style="color:#f92672">-</span>(f(x_n)<span style="color:#f92672">/</span>derivative(f,x_n))

    <span style="color:#66d9ef">return</span> x_n1
</code></pre></div><ul>
<li>Convergence condition</li>
</ul>
<p>$\left|\frac{f(x)f&rsquo;'(x)}{[f&rsquo;(x)]^2}\right|&lt;1$</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">converges</span>(f,x_n):
    
    <span style="color:#f92672">from</span> scipy.misc <span style="color:#f92672">import</span> derivative
    
    numerator<span style="color:#f92672">=</span>f(x_n)<span style="color:#f92672">*</span>derivative(f,x_n,n<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>) <span style="color:#75715e"># parameter &#39;n&#39; for order of derivative</span>
    denominator<span style="color:#f92672">=</span>derivative(f,x_n)<span style="color:#f92672">**</span><span style="color:#ae81ff">2</span>
    
    <span style="color:#66d9ef">return</span> abs(numerator<span style="color:#f92672">/</span>denominator)<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">1</span>
</code></pre></div><ul>
<li>Precision:</li>
</ul>
<p>$|x_n-x_{n+1}|$</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">precise_enough</span>(x_n,x_n1,error):
      
    <span style="color:#66d9ef">return</span> abs(x_n<span style="color:#f92672">-</span>x_n1)<span style="color:#f92672">&lt;=</span>error
</code></pre></div><p>Complete algorithm:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">newton_method</span>(f,x_n,error<span style="color:#f92672">=</span><span style="color:#ae81ff">0.01</span>):
    
    <span style="color:#66d9ef">if</span> converges(f,x_n):
        
        x_n1<span style="color:#f92672">=</span>iterative_formula(f,x_n)

        iters<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>
        <span style="color:#66d9ef">while</span> <span style="color:#f92672">not</span> precise_enough(x_n,x_n1,error):
            x_n<span style="color:#f92672">=</span>x_n1
            x_n1<span style="color:#f92672">=</span>iterative_formula(f,x_n)
            iters<span style="color:#f92672">+=</span><span style="color:#ae81ff">1</span>

        <span style="color:#66d9ef">return</span> x_n1,iters
    <span style="color:#66d9ef">else</span>:
        <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Newton&#39;s method fails to converge&#34;</span>)
</code></pre></div><p>The code is available <a href="https://github.com/Diego-Hernandez-Jimenez/Newton-Raphson-method">here</a></p>
<h3 id="comments">Comments</h3>
<ul>
<li>I tested the code with several examples (you can check it in my github) and it seems to work fine. However, there are some examples that produce strange results. In other cases, the answer is correct but slightly different from the
obtained using other code versions of the newton method algorithm. I wouldn&rsquo;t say that makes the program a failure, but it necessarily means that I&rsquo;ve written a function that doesn&rsquo;t capture all the elements needed to solve the problem properly.</li>
<li>The function doesn&rsquo;t return a tuple or a list with all the real zeros, just one solution, because the output depends on the first estimate given as argument. For instance, if you pass the function $f(x)=x^2-2$ and the estimate $x_1=1$, you get as a result $\approx{1.41}$ ($+\sqrt{2}$ ), but if you pass as first approximation $x_1=-1$ you get the other zero, which is $\approx{-1.41}$ ($-\sqrt{2}$ ). This forces the user to have in advance a rough idea of the value of the solutions.</li>
</ul>


</article>


<section class="post-nav">
    <ul>
        
        <li>
            <a href="https://diego-hernandez-jimenez.github.io/web/posts/ibm/"><i class="fa fa-chevron-circle-left"></i> Analyzing Data with Python (edX project)</a>
        </li>
        
        
        <li>
            <a href="https://diego-hernandez-jimenez.github.io/web/posts/monty_hall/">Monty Hall problem simulation <i class="fa fa-chevron-circle-right"></i> </a>
        </li>
        
    </ul>
</section>
  
    
    
  





</main>
    <footer>
        <h6>Copyright &amp; copy; 2020 - Diego Hernández Jiménez |
            Rendered by <a href="https://gohugo.io" title="Hugo">Hugo</a> |
            <a href="https://diego-hernandez-jimenez.github.io/web/index.xml">Subscribe </a></h6>
    </footer>
</div>
<script src="https://diego-hernandez-jimenez.github.io/web/js/scripts.js"></script>

</body>

</html>

